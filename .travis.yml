#
# Builds the C++ standard document on Travis CI <https://travis-ci.com/cplusplus/draft>
#

dist: trusty
sudo: required
language: cpp

services:
  - docker

before_install:
  - docker pull godbyk/texlive-basic:latest
  - docker run -itd -v $TRAVIS_BUILD_DIR:/$TRAVIS_REPO_SLUG --name texlive-basic godbyk/texlive-basic

script:
  # Build std.pdf
  - pushd source
  - docker exec -it texlive-basic bash -c "cd /$TRAVIS_REPO_SLUG/source && make";
  - ../tools/check.sh;
  - popd
  # Check to see if generated files are out-dated
  - pushd source
  - for FIGURE in *.dot; do
      docker exec -it texlive-basic bash -c "cd /$TRAVIS_REPO_SLUG/source && make $(basename $FIGURE .dot).pdf";
      git status --porcelain $(basename $FIGURE .dot).pdf;
    done
  - popd

